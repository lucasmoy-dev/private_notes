export const translations = {
    en: {
        app_name: "Private Notes",
        sidebar: {
            all_notes: "All Notes",
            tags: "Tags",
            manage_tags: "Manage Tags",
            settings: "Settings",
            install_app: "Install App",
            system: "System",
            force_reload: "Force Cleanup & Reload"
        },
        header: {
            search_placeholder: "Search notes...",
            sync: "Sync Now",
            install: "Install",
            new_note: "New Note",
            view_title_all: "All Notes",
            view_desc_all: "Organize your thoughts and protect your privacy."
        },
        auth: {
            title: "Protected Vault",
            desc: "Enter your master password to continue",
            unlock: "Unlock",
            setup_title: "Setup your Vault",
            setup_desc: "Create a master password. Enter it twice to confirm.",
            create_vault: "Create my Vault",
            confirm_pass: "Repeat password",
            pass_placeholder: "Your password",
            repeat_placeholder: "Repeat password",
            remember_me: "Remember my password in this browser",
            problems: "Problems? Force cleanup & reload",
            password_mismatch: "⚠️ Passwords do not match!",
            password_short: "Password must be at least 4 chars",
            vault_created: "✅ Vault created successfully",
            vault_opened: "Vault opened",
            incorrect_pass: "❌ Incorrect password",
            setup_pass_first: "⚠️ Enter your password first to configure",
            bio_success: "✅ Biometrics activated",
            bio_fail: "❌ Biometric auth failed",
            bio_unlock: "Unlock with Biometrics",
            bio_setup: "Enable Biometrics / FaceID",
            use_bio: "Use Biometrics / FaceID"
        },
        editor: {
            title_placeholder: "Note Title",
            content_placeholder: "Start writing...",
            saving: "Saving...",
            saved: "Saved",
            error_save: "Error saving",
            delete_confirm: "Delete this note?",
            close_unsaved: "Close without saving?",
            tools: {
                bg_color: "Background Color",
                text_format: "Text Format"
            }
        },
        settings: {
            title: "Settings",
            general: "General",
            sync: "Cloud Sync",
            security: "Security",
            danger: "Danger Zone",
            theme: "Visual Theme",
            light: "Light",
            dark: "Dark",
            lang: "Language",
            maintenance: "Maintenance",
            installed_version: "Installed Version",
            sync_status: {
                connected: "Connected",
                disconnected: "Disconnected"
            },
            connect_drive: "Connect with Google Drive",
            drive_folder: "Drive Folder Name",
            drive_folder_hint: "Notes will be encrypted inside this folder.",
            notes_per_chunk: "Notes per file (Group)",
            notes_per_chunk_hint: "Defines how many notes are grouped per file.",
            save_changes: "Save Changes",
            session_security: "Session Security",
            logout: "Logout",
            logout_hint: "Logging out clears the access key from memory.",
            encryption: "Encryption",
            algo: "Preferred Algorithm",
            update_algo: "Update Algorithm",
            reset_app: "Reset Application",
            reset_warning: "This will permanently delete all local notes and categories.",
            reset_confirm_label: "To confirm, type \"confirm\" below:",
            reset_btn: "Delete all local data",
            reset_keyword: "confirm"
        },
        categories: {
            title: "Manage Categories",
            add_new: "New Category",
            name_placeholder: "Category Name",
            icon_label: "Icon",
            color_label: "Color",
            password_label: "Password (Optional)",
            password_hint: "Leave empty for no protection",
            create: "Create Category",
            edit: "Edit Category",
            delete: "Delete",
            save: "Save Category",
            delete_confirm: "Delete this category? Notes will be kept but untagged.",
            no_category: "Uncategorized"
        },
        common: {
            cancel: "Cancel",
            confirm: "Confirm",
            search: "Search",
            search_prompt: "Enter search term:",
            security_prompt: "Security",
            security_desc_prompt: "Enter password to continue",
            restricted_access: "Restricted Access",
            enter_cat_pass: "Enter password for category",
            write_here: "Write here..."
        }
    },
    es: {
        app_name: "Notas Privadas",
        sidebar: {
            all_notes: "Todas las notas",
            tags: "Etiquetas",
            manage_tags: "Gestionar Etiquetas",
            settings: "Configuración",
            install_app: "Instalar Aplicación",
            system: "Sistema",
            force_reload: "Forzar Limpieza y Recarga"
        },
        header: {
            search_placeholder: "Buscar notas...",
            sync: "Sincronizar",
            install: "Instalar",
            new_note: "Nueva Nota",
            view_title_all: "Todas las notas",
            view_desc_all: "Organiza tus pensamientos y protege tu privacidad."
        },
        auth: {
            title: "Bóveda Protegida",
            desc: "Ingresa tu contraseña maestra para continuar",
            unlock: "Desbloquear",
            setup_title: "Configura tu Bóveda",
            setup_desc: "Crea una contraseña maestra. Introduce la contraseña dos veces para asegurar que es correcta.",
            create_vault: "Crear mi Bóveda",
            confirm_pass: "Repite la contraseña",
            pass_placeholder: "Tu contraseña",
            repeat_placeholder: "Repite la contraseña",
            remember_me: "Recordar mi contraseña en este navegador",
            problems: "¿Problemas? Forzar limpieza y recarga",
            password_mismatch: "⚠️ ¡Las contraseñas no coinciden!",
            password_short: "La contraseña debe tener al menos 4 caracteres",
            vault_created: "✅ Bóveda creada con éxito",
            vault_opened: "Bóveda abierta",
            incorrect_pass: "❌ Contraseña incorrecta",
            setup_pass_first: "⚠️ Ingresa tu contraseña primero para configurar",
            bio_success: "✅ Huella activada",
            bio_fail: "❌ Autenticación biométrica fallida",
            bio_unlock: "Desbloquear con Huella",
            bio_setup: "Activar Huella / FaceID",
            use_bio: "Usar Huella / FaceID"
        },
        editor: {
            title_placeholder: "Título de la nota",
            content_placeholder: "Empieza a escribir...",
            saving: "Guardando...",
            saved: "Guardado",
            error_save: "Error al guardar",
            delete_confirm: "¿Eliminar esta nota?",
            close_unsaved: "¿Cerrar sin guardar?",
            tools: {
                bg_color: "Color de Fondo",
                text_format: "Formato de Texto"
            }
        },
        settings: {
            title: "Configuración",
            general: "General",
            sync: "Sincronización Cloud",
            security: "Seguridad y Sesión",
            danger: "Zona Peligrosa",
            theme: "Tema Visual",
            light: "Claro",
            dark: "Oscuro",
            lang: "Idioma",
            maintenance: "Mantenimiento",
            installed_version: "Versión Instalada",
            sync_status: {
                connected: "Conectado",
                disconnected: "Desconectado"
            },
            connect_drive: "Conectar con Google Drive",
            drive_folder: "Nombre de carpeta en Drive",
            drive_folder_hint: "Las notas se guardarán encriptadas dentro de esta carpeta.",
            notes_per_chunk: "Notas por archivo (Grupo)",
            notes_per_chunk_hint: "Define cuántas notas se agruparán en cada archivo.",
            save_changes: "Guardar Cambios",
            session_security: "Seguridad de la Sesión",
            logout: "Cerrar Sesión",
            logout_hint: "Cerrar la sesión actual eliminará la clave de acceso de la memoria.",
            encryption: "Encriptación",
            algo: "Algoritmo preferido",
            update_algo: "Actualizar Algoritmo",
            reset_app: "Restablecer Aplicación",
            reset_warning: "Esta acción borrará permanentemente todas las notas y categorías almacenadas localmente.",
            reset_confirm_label: "Para confirmar, escribe \"confirmar\" a continuación:",
            reset_btn: "Eliminar todos los datos locales",
            reset_keyword: "confirmar"
        },
        categories: {
            title: "Gestionar Categorías",
            add_new: "Nueva Categoría",
            name_placeholder: "Nombre de la categoría",
            icon_label: "Icono",
            color_label: "Color",
            password_label: "Contraseña (Opcional)",
            password_hint: "Dejar vacío para sin protección",
            create: "Crear Categoría",
            edit: "Editar Categoría",
            delete: "Eliminar",
            save: "Guardar Categoría",
            delete_confirm: "¿Eliminar esta categoría? Las notas se mantendrán pero sin etiqueta.",
            no_category: "Sin categoría"
        },
        common: {
            cancel: "Cancelar",
            confirm: "Confirmar",
            search: "Buscar",
            search_prompt: "Ingresa término de búsqueda:",
            security_prompt: "Seguridad",
            security_desc_prompt: "Ingresa la contraseña para continuar",
            restricted_access: "Acceso Restringido",
            enter_cat_pass: "Ingresa la contraseña para",
            write_here: "Escribe aquí..."
        }
    }
};

export let currentLang = 'en';

export function initI18n() {
    const saved = localStorage.getItem('cn_lang');
    const browser = navigator.language.split('-')[0];
    // Default to EN if not ES
    currentLang = saved || (browser === 'es' ? 'es' : 'en');
    document.documentElement.lang = currentLang;
}

export function setLanguage(lang) {
    if (translations[lang]) {
        currentLang = lang;
        localStorage.setItem('cn_lang', lang);
        document.documentElement.lang = lang;
        location.reload(); // Simple reload to apply all changes
    }
}

export function t(key) {
    const keys = key.split('.');
    let val = translations[currentLang];
    for (const k of keys) {
        val = val?.[k];
        if (!val) break;
    }
    return val || key;
}
