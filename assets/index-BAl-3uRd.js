import{W as c,r as o}from"./index-CnQ1bllt.js";class m extends c{constructor(){super(...arguments),this.ERROR_PICK_FILE_CANCELED="pickFiles canceled."}async checkPermissions(){throw this.unimplemented("Not implemented on web.")}async convertHeicToJpeg(e){throw this.unimplemented("Not implemented on web.")}async pickFiles(e){const t=await this.openFilePicker(e);if(!t)throw new Error(this.ERROR_PICK_FILE_CANCELED);const r={files:[]};for(const i of t){const s={blob:i,modifiedAt:i.lastModified,mimeType:this.getMimeTypeFromUrl(i),name:this.getNameFromUrl(i),path:void 0,size:this.getSizeFromUrl(i)};e!=null&&e.readData&&(s.data=await this.getDataFromFile(i)),r.files.push(s)}return r}async pickDirectory(){throw this.unimplemented("Not implemented on web.")}async pickImages(e){return this.pickFiles(Object.assign({types:["image/*"]},e))}async pickMedia(e){return this.pickFiles(Object.assign({types:["image/*","video/*"]},e))}async pickVideos(e){return this.pickFiles(Object.assign({types:["video/*"]},e))}async requestPermissions(e){throw this.unimplemented("Not implemented on web.")}async openFilePicker(e){var t;const r=((t=e==null?void 0:e.types)===null||t===void 0?void 0:t.join(","))||"",i=(e==null?void 0:e.limit)===void 0?0:e.limit;return new Promise(s=>{let l=!1;const n=document.createElement("input");n.type="file",n.accept=r,n.multiple=i===0,n.addEventListener("change",()=>{l=!0;const a=Array.from(n.files||[]);s(a)},{once:!0}),window.addEventListener("focus",async()=>{await this.wait(1e3),!l&&s(void 0)},{once:!0}),n.click()})}async getDataFromFile(e){return new Promise((t,r)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>{const n=(typeof i.result=="string"?i.result:"").split("base64,")[1]||"";t(n)},i.onerror=s=>{r(s)}})}getNameFromUrl(e){return e.name}getMimeTypeFromUrl(e){return e.type}getSizeFromUrl(e){return e.size}async wait(e){return new Promise(t=>setTimeout(t,e))}}const p=o("FilePicker",{web:()=>new m});export{p as FilePicker};
