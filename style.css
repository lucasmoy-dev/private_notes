@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        --background: 0 0% 100%;
        --foreground: 240 10% 3.9%;
        --card: 0 0% 100%;
        --card-foreground: 240 10% 3.9%;
        --popover: 0 0% 100%;
        --popover-foreground: 240 10% 3.9%;
        --primary: 240 5.9% 10%;
        --primary-foreground: 0 0% 98%;
        --secondary: 240 4.8% 95.9%;
        --secondary-foreground: 240 5.9% 10%;
        --muted: 240 4.8% 95.9%;
        --muted-foreground: 240 3.8% 46.1%;
        --accent: 240 4.8% 95.9%;
        --accent-foreground: 240 5.9% 10%;
        --destructive: 0 84.2% 60.2%;
        --destructive-foreground: 0 0% 98%;
        --border: 240 5.9% 90%;
        --input: 240 5.9% 90%;
        --ring: 240 5.9% 10%;
        --radius: 0.5rem;
    }

    .dark {
        --background: 240 10% 6%;
        --foreground: 0 0% 98%;
        --card: 240 10% 9%;
        --card-foreground: 0 0% 98%;
        --sidebar: 240 10% 7%;
        --popover: 240 10% 10%;
        --popover-foreground: 0 0% 98%;
        --primary: 240 5.9% 20%;
        --primary-foreground: 0 0% 98%;
        --secondary: 240 3.7% 18.9%;
        --secondary-foreground: 0 0% 98%;
        --muted: 240 3.7% 18.9%;
        --muted-foreground: 240 5% 70%;
        --accent: 240 3.7% 22%;
        --accent-foreground: 0 0% 98%;
        --destructive: 0 84% 60%;
        --destructive-foreground: 210 40% 98%;
        --border: 240 3.7% 20%;
        --input: 240 3.7% 20%;
        --ring: 240 4.9% 83.9%;
    }
}

@layer base {
    * {
        @apply border-border;
    }

    body {
        @apply bg-background text-foreground transition-colors duration-300 antialiased font-sans;
        font-feature-settings: "cv02", "cv03", "cv04", "cv11";
    }
}

@layer components {
    .btn-shad {
        @apply inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2;
    }

    #mobile-add-btn {
        @apply bg-primary text-primary-foreground shadow-lg shadow-primary/30 flex items-center justify-center;
        width: 3.5rem;
        height: 3.5rem;
        border-radius: 1rem;
    }

    .light #mobile-add-btn {
        @apply bg-primary text-white;
    }

    .btn-shad-secondary {
        @apply bg-secondary text-secondary-foreground hover:bg-secondary/80;
    }

    .btn-shad-success {
        @apply bg-emerald-600 text-white hover:bg-emerald-700 shadow-md;
    }

    .btn-shad-outline {
        @apply border border-input bg-background hover:bg-accent hover:text-accent-foreground;
    }

    .btn-shad-ghost {
        @apply hover:bg-accent hover:text-accent-foreground;
    }

    .nav-link {
        @apply flex items-center justify-start gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors;
        @apply text-muted-foreground hover:bg-accent hover:text-accent-foreground;
    }

    .nav-link.active {
        @apply bg-accent text-accent-foreground font-semibold;
    }

    .card-shad {
        @apply rounded-xl border bg-card text-card-foreground shadow-sm;
    }

    .dialog-overlay {
        @apply fixed inset-0 z-50 bg-black/80 backdrop-blur-sm transition-all duration-300;
    }

    .dialog-content {
        @apply fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-0 border bg-background shadow-2xl duration-200 animate-in fade-in-0 zoom-in-95 sm:rounded-xl;
    }

    .dialog-content.fullscreen-mode {
        @apply fixed inset-0 w-screen h-screen max-w-none max-h-none translate-x-0 translate-y-0 left-0 top-0 z-[60] rounded-none border-none p-0 !important;
    }

    .popover-content {
        @apply z-50 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none animate-in fade-in-0 zoom-in-95;
    }

    .editor-tool {
        @apply h-9 w-9 inline-flex items-center justify-center rounded-md hover:bg-accent hover:text-accent-foreground text-muted-foreground transition-all duration-200 shrink-0;
    }

    .editor-tool.active {
        @apply bg-primary text-primary-foreground border-primary shadow-sm;
        opacity: 1 !important;
    }

    .editor-tool i {
        @apply transition-transform duration-200;
    }

    .editor-tool:active i {
        @apply scale-90;
    }

    /* Note Card */
    .note-card {
        @apply card-shad relative transition-all duration-200 hover:ring-1 hover:ring-ring border cursor-pointer flex flex-col;
    }

    .note-card:hover {
        @apply shadow-md;
    }

    .note-card-content {
        @apply p-4 flex flex-col h-full;
    }

    .note-card.pinned {
        @apply border-primary/50 ring-1 ring-primary/20;
    }
}

/* Sidebar Custom Styling */
aside {
    @apply hidden md:flex flex-col border-r bg-card transition-all duration-300 ease-in-out;
    width: 280px;
}

aside.collapsed {
    width: 80px !important;
}

main {
    @apply flex-1 flex flex-col min-w-0 transition-all duration-300 ease-in-out;
}

.ov-hidden {
    overflow: hidden;
}

/* Fix input padding overlap */
input.pl-12 {
    padding-left: 3rem !important;
    /* 48px */
}

.absolute.left-4 {
    left: 1rem !important;
    /* 16px */
}

/* Sidebar Headings */
.sidebar-section-title {
    @apply text-[10px] font-bold text-muted-foreground/60 uppercase tracking-[0.2em] px-4 mb-2;
}

/* Password eye toggle */
.toggle-pass {
    @apply transition-colors h-11 w-11 flex items-center justify-center rounded-md absolute right-0 top-1/2 -translate-y-1/2;
}

.toggle-pass i {
    @apply opacity-50;
}

/* Scrollbar styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    @apply bg-transparent;
}

::-webkit-scrollbar-thumb {
    @apply bg-muted rounded-full border-4 border-solid border-background hover:bg-muted-foreground/30;
}

/* Animations */
@keyframes note-in {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.note-animate-in {
    animation: note-in 0.3s ease-out forwards;
}

/* Input Styles */
input[type="text"],
input[type="password"],
input[type="email"],
input[type="number"],
select,
textarea {
    @apply flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all;
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    max-width: 100%;
}

@media (max-width: 640px) {

    input[type="password"],
    input[type="text"] {
        @apply h-11 !important;
    }
}

.dark input[type="text"],
.dark input[type="password"],
.dark select {
    background-color: hsl(var(--card));
    border-color: hsl(var(--border));
    color: rgba(255, 255, 255, 0.9);
}

.dark input:focus {
    border-color: hsl(var(--ring));
    background-color: hsl(var(--accent));
}

/* Custom Dropdown */
#cat-dropdown-menu {
    @apply bg-popover text-popover-foreground border shadow-2xl rounded-xl p-1.5 mt-2 min-w-[200px] z-[100];
    transform-origin: top left;
    animation: dropdown-in 0.2s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes dropdown-in {
    from {
        opacity: 0;
        transform: scale(0.95) translateY(-10px);
    }

    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

#cat-dropdown-menu div {
    @apply relative flex cursor-pointer select-none items-center rounded-lg px-3 py-2 text-sm outline-none transition-all hover:bg-accent hover:text-accent-foreground gap-2 mb-0.5 last:mb-0;
}

#cat-dropdown-menu div:active {
    @apply scale-[0.98];
}

/* Grid Layout */
#notes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.25rem;
}

@media (max-width: 640px) {
    #notes-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
    }

    #notes-viewport {
        padding: 0.75rem 0.5rem 5rem 0.5rem;
    }

    .dialog-content {
        @apply w-full h-full max-w-none max-h-none rounded-none p-4 bottom-0 left-0 translate-x-0 translate-y-0 fixed inset-0 !important;
    }

    /* Hide Desktop Header on Mobile */
    header.md\:flex {
        display: none !important;
    }

    #mobile-search-bar {
        @apply h-full w-full z-[120] left-0 top-0;
    }

    /* Editor Spacing Refinements */
    #edit-title {
        @apply text-lg !important;
    }

    .editor-toolbar-container {
        @apply mb-2 !important;
    }

    #edit-content {
        @apply min-h-[50vh] !important;
    }

    /* Editor Mobile Tweaks */
    .editor-tool {
        @apply h-8 w-8 !important;
    }

    .editor-toolbar-container {
        @apply flex overflow-x-auto no-scrollbar py-1 gap-1;
    }

    .editor-bottom-bar {
        @apply flex-wrap gap-y-3 !important;
    }

    /* Settings Mobile Tweaks */
    #settings-modal .dialog-content {
        @apply h-[90vh] md:h-[500px];
    }

    #settings-modal .md\:w-48 {
        @apply flex-wrap p-2 !important;
    }

    .settings-tab {
        @apply py-2 px-3 text-xs !important;
    }

    #categories-modal .dialog-content {
        @apply max-h-[80vh] h-auto rounded-t-2xl bottom-0 top-auto translate-y-0 !important;
    }
}

/* Collapsible Sidebar Support */
aside.collapsed {
    @apply w-16 !important;
}

aside.collapsed .nav-link span,
aside.collapsed .sidebar-section-title,
aside.collapsed h1,
aside.collapsed #sidebar-manage-cats span,
aside.collapsed #settings-trigger span,
aside.collapsed #sidebar-pwa-install-btn span,
aside.collapsed #app-version {
    display: none !important;
}

aside.collapsed .p-6 {
    @apply px-3 !important;
}

aside.collapsed .nav-link {
    @apply justify-center px-0 !important;
}

/* Mobile Tools Menu */
#mobile-tools-menu {
    @apply absolute bottom-full left-0 mb-2 bg-popover border shadow-2xl rounded-xl p-1 z-[110] flex flex-col gap-0.5 min-w-[140px] animate-in slide-in-from-bottom-2 duration-200;
}

#mobile-tools-menu button {
    @apply flex items-center gap-3 px-3 py-2 text-sm hover:bg-accent rounded-md transition-colors;
}

/* Status dots */
#drive-status.active {
    @apply bg-green-500/10 text-green-500;
}

/* Early Auth Check Hide */
html.auth-pre-verified #auth-shield {
    display: none !important;
}

html.auth-pre-verified #app {
    opacity: 1 !important;
}

/* Mobile Sidebar Drawer */
.nav-link-mobile-drawer {
    @apply flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all text-muted-foreground hover:bg-accent hover:text-accent-foreground;
}

.nav-link-mobile-drawer.active {
    @apply bg-primary/10 text-primary font-bold border-l-4 border-primary;
}

.nav-link-mobile-drawer.active i {
    @apply text-primary;
}

/* Fix mobile add btn translate */
#mobile-add-btn div {
    @apply -translate-y-6 !important;
}

#mobile-sidebar-drawer {
    box-shadow: 20px 0 50px rgba(0, 0, 0, 0.2);
}

/* Animations */
.animate-in {
    animation-duration: 200ms;
    animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);
    animation-fill-mode: forwards;
}

.slide-in-from-left {
    from {
        transform: translateX(-100%);
    }

    to {
        transform: translateX(0);
    }
}

.slide-in-from-top {
    from {
        transform: translateY(-100%);
    }

    to {
        transform: translateY(0);
    }
}

.hidden {
    display: none;
}

/* Forms and Inputs */
input,
select,
textarea {
    @apply transition-all duration-200 outline-none;
}

input:focus,
select:focus,
textarea:focus {
    @apply ring-2 ring-primary/20 border-primary shadow-sm !important;
}

/* Settings Tabs */
.settings-tab {
    @apply flex items-center gap-2 px-3 py-2 text-xs font-medium rounded-md transition-all text-muted-foreground w-full;
}

.settings-tab:hover {
    @apply bg-accent text-accent-foreground;
}

.settings-tab.active {
    @apply bg-background text-foreground shadow-sm border border-border/50;
}

.settings-tab.active i {
    @apply text-primary;
}

/* Toast System - Standard CSS for maximum reliability */
#toast {
    position: fixed;
    bottom: 5rem;
    left: 50%;
    transform: translateX(-50%) translateY(1rem);
    z-index: 500;
    pointer-events: none;
    opacity: 0;
    transition: all 0.3s ease;
    display: flex;
    justify-content: center;
    width: max-content;
}

#toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

#toast div {
    background-color: #18181b;
    /* zinc-900 */
    color: #ffffff;
    padding: 0.75rem 1.5rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 500;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    border: 1px solid #27272a;
    /* zinc-800 */
}

.dark #toast div {
    background-color: #f4f4f5;
    /* zinc-100 */
    color: #09090b;
    /* zinc-950 */
    border-color: #e4e4e7;
    /* zinc-200 */
}

/* Fix for logout button visibility */
.text-destructive {
    @apply text-red-500 dark:text-red-400 font-medium;
}

.hover\:bg-destructive:hover {
    @apply bg-red-600 text-white;
}

/* Checklist & Editor Content */
#edit-content ul,
#edit-content ol {
    padding-left: 1.5rem;
    margin-bottom: 1rem;
}

#edit-content ul {
    list-style-type: disc;
}

#edit-content ol {
    list-style-type: decimal;
}

#edit-content li {
    margin-bottom: 0.25rem;
}

/* New Checklist Implementation */
ul.checklist {
    list-style-type: none;
    padding-left: 1.5rem;
}

ul.checklist li {
    position: relative;
    cursor: pointer;
    transition: all 0.2s;
    padding-left: 0.5rem;
}

ul.checklist li::before {
    content: '';
    position: absolute;
    left: -1.4rem;
    top: 0.2rem;
    width: 1rem;
    height: 1rem;
    border: 2px solid rgba(var(--primary), 0.3);
    border-radius: 4px;
    background: transparent;
    transition: all 0.2s;
}

ul.checklist li[data-checked="true"] {
    @apply line-through opacity-50;
}

ul.checklist li[data-checked="true"]::before {
    @apply bg-primary border-primary;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='4' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
    background-size: 80%;
    background-position: center;
    background-repeat: no-repeat;
}

#edit-content a {
    color: #3b82f6 !important;
    /* Vibrant Blue */
    text-decoration: underline;
    font-weight: 500;
}

.dark #edit-content a {
    color: #60a5fa !important;
}

/* Scrollbar Hide for toolbar */
.no-scrollbar::-webkit-scrollbar {
    display: none;
}

.no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
}